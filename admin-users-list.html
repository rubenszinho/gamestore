<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game Store - Users List</title>
  <link rel="stylesheet" href="styles/globals.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
  <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/rubenszinho/gamestore/develop/public/assets/favico.ico">
</head>

<body>
  <div class="content">
    <div class="navbar">
      <div class="nav-items">
        <a href="login">Login</a>
        <a href="/">Home</a>
        <a href="search">Category</a>
        <a href="my-cart">My Cart</a>
        <a href="user-profile">User Profile</a>
        <a id="adminLink" href="admin-page">Admin</a>
      </div>
      <div class="search-container">
        <input class="search-input" type="text" placeholder="Search games..." onkeydown="onSearchEnter(event)" />
        <button class="search-button" onclick="onSearchClick()">Search</button>
      </div>
      <div>
        <button class="theme-toggle" onclick="toggleTheme()">
          <span class="material-symbols-outlined">brightness_medium</span>
        </button>
      </div>
    </div>

    <div class="container">
      <h1 class="title">Users List</h1>
      <div class="users-info">
        <div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-container">
      <div class="footer-section">
        <h3>About</h3>
        <p>Welcome to Game Store, your source for the best games at the best prices.</p>
      </div>
      <div class="footer-section">
        <h3>Contact Us</h3>
        <p>Email: support@gamestore.com</p>
        <p>Phone: +1 (555) 123-4567</p>
      </div>
      <div class="footer-section">
        <h3>Follow Us</h3>
        <p><a href="#">Facebook</a></p>
        <p><a href="#">Twitter</a></p>
        <p><a href="#">Instagram</a></p>
      </div>
    </div>
  </footer>

  <script src="scripts/script.js"></script>
  <script>
    // Obtém os dados de usuários armazenados na sessionStorage
    var usersData = sessionStorage.getItem('users');
    // Verifica se há dados de usuários armazenados
    if (usersData) {
      // Converte os dados de usuários de uma string JSON para um objeto JavaScript
      var users = JSON.parse(usersData);

      // Seleciona o elemento HTML onde a lista de usuários será exibida
      var usersList = document.querySelector('.users-info');

      // Verifica se há usuários para exibir
      if (users.length > 0) {
        // Cria uma lista não ordenada para exibir os usuários
        var userListElement = document.createElement('ul');

        // Itera sobre cada usuário e cria um item de lista para cada um
        users.forEach(function(user) {
          var userItem = document.createElement('li');
          userItem.textContent = 'ID: ' + user.id + ', Name: ' + user.name + ', Email: ' + user.email;

          // Cria botão de deletar
          var deleteButton = document.createElement('button');
          deleteButton.textContent = 'Delete';
          deleteButton.classList.add('button');
          deleteButton.addEventListener('click', function() {
            // Chama a função para deletar o usuário
            deleteUser(user.id);
          });
          userItem.appendChild(deleteButton);

          // Cria botão de editar
          var editButton = document.createElement('button');
          editButton.textContent = 'Edit';
          editButton.classList.add('button');
          editButton.addEventListener('click', function() {
            // Redireciona para a página de edição do perfil do usuário
            window.location.href = '/edit-profile';
          });
          userItem.appendChild(editButton);

          userListElement.appendChild(userItem);
        });

        // Adiciona a lista de usuários ao elemento HTML
        usersList.appendChild(userListElement);
      } else {
        // Caso não haja usuários, exibe uma mensagem informando isso
        usersList.textContent = 'No users found.';
      }
    } else {
      // Caso não haja dados de usuários armazenados, exibe uma mensagem informando isso
      var usersList = document.querySelector('.users-info');
      usersList.textContent = 'No user data found in sessionStorage.';
    }

    // Função para deletar um usuário
    function deleteUser(userId) {
      // Obtém os dados de usuários armazenados na sessionStorage
      var usersData = sessionStorage.getItem('users');

      // Verifica se há dados de usuários armazenados
      if (usersData) {
        // Converte os dados de usuários de uma string JSON para um objeto JavaScript
        var users = JSON.parse(usersData);

        // Encontra o índice do usuário com base no userId
        var userIndex = users.findIndex(function(user) {
          return user.id === userId;
        });

        // Verifica se o usuário foi encontrado
        if (userIndex !== -1) {
          // Remove o usuário do array de usuários
          users.splice(userIndex, 1);

          // Atualiza os dados de usuários na sessionStorage
          sessionStorage.setItem('users', JSON.stringify(users));

          // Recarrega a página para refletir a remoção do usuário
          location.reload();
        }
      }
    }

  </script>
</body>

</html>